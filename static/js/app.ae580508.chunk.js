(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{374:function(e,t,n){"use strict";n.d(t,"a",(function(){return se}));var r=n(67),a=n.n(r),c=n(0),o=n.n(c),i=n(64),s=n(95),u=n(350),d=n(85),l=n.n(d),f=n(372),p=n(910),b=n(34),m=n(6),j=n(371),h=n(3),v=n(32),g=n(376),y=n(17),O=n(45),E=n.n(O),w=n(348),x=n(375),I=n(35),D=n(187),L=n(13),P=Object(w.a)({apiKey:"AIzaSyB8I11ntIAhLCoz2iw2cWVZl6NoWQ44yR0",authDomain:"perfectgraph-5c619.firebaseapp.com",databaseURL:"https://perfectgraph-5c619.firebaseio.com",projectId:"perfectgraph-5c619",storageBucket:"perfectgraph-5c619.appspot.com",messagingSenderId:"214633043236",appId:"1:214633043236:web:fa42d761199303b786cfb1",measurementId:"G-GYX9R6E88Y"}),k=(Object(x.a)(P),Object(I.d)(P)),S=Object(D.b)(P),T="projects",A="nodes",C="edges",N="users";function z(e){var t,n,r;return E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.id,n=e.projectId;try{r=Object(I.c)(k,T+"/"+n+"/"+C+"/"+t),Object(I.b)(r)}catch(c){console.log("error creating node:",c)}case 2:case"end":return a.stop()}}),null,null,null,Promise)}function F(e){var t,n,r;return E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.user,n=e.projectId;try{r=Object(I.c)(k,T+"/"+n+"/"+N+"/"+t.id),Object(I.f)(r,t)}catch(c){console.log("error update user:",c)}case 2:case"end":return a.stop()}}),null,null,null,Promise)}function M(e){var t,n,r;return E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.id,n=e.projectId;try{r=Object(I.c)(k,T+"/"+n+"/"+N+"/"+t),Object(I.b)(r)}catch(c){console.log("error deleting user:",c)}case 2:case"end":return a.stop()}}),null,null,null,Promise)}var R=n(230),G=n(21),U=n(33),_=n.n(U),V=n(49),B=n(16),H=n.n(B),W=n(2),Y=function(e){var t=e.user,n=e.position,r=e.label,a=o.a.useRef({targetPosition:n}),c=o.a.useRef(),i=o.a.useMemo((function(){var e="#"+Math.floor(16777215*Math.random()).toString(16);return console.log("a",e,H()(e).rgbNumber()),H()(e).rgbNumber()}),[t.id]),s=o.a.useCallback((function(e){J({graphics:e,fill:i,to:{x:0,y:0},unitVector:{x:-2,y:-2}})}),[i]);return o.a.useMemo((function(){a.current.targetPosition=n}),[n]),o.a.useEffect((function(){c.current.x=n.x,c.current.y=n.y;var e=function(){var e=c.current;if(e){var t=_.a.fromObject(a.current.targetPosition),n=_.a.fromObject(e),r=t.clone().subtract(n);if(r.length()<5)e.x=t.x,e.y=t.y;else{var o=r.clone().normalize(),i=n.clone().add(o.clone().multiplyScalar(5));e.x=i.x,e.y=i.y}}};return G.t.shared.add(e),function(){G.t.shared.remove(e)}}),[]),Object(W.jsxs)(V.Container,{ref:c,x:0,y:0,children:[Object(W.jsx)(R.a.Graphics,{draw:s}),Object(W.jsx)(R.a.Text,{text:r})]})},J=function(e){var t=e.graphics,n=e.to,r=e.radius,a=void 0===r?10:r,c=e.unitVector,o=e.fill,i=_.a.fromObject(n),s=_.a.fromObject(c).multiplyScalar(a),u=s.clone().rotate(-Math.PI/2),d=u.clone().multiplyScalar(-1).add(i),l=u.clone().add(i),f=i.clone().add(s);t.beginFill(o),t.drawPolygon(new G.l(d.x,d.y),new G.l(l.x,l.y),new G.l(f.x,f.y)),t.endFill()};function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X="daa9975c-6bdc-4ab3-9a01-2d1dca1f2290",Z=function(e){return Object.keys(e.typography).forEach((function(t){var n;null!=(n=e.typography[t])&&n.fontSize&&(e.typography[t].fontSize=16*Number(e.typography[t].fontSize.replace("rem",""))*.8)})),e},$={Dark:Z(Object(f.a)({palette:{mode:"dark"},spacing:4,components:{MuiTextField:{defaultProps:{size:"small"}}}})),Default:Z(Object(f.a)({palette:{mode:"light"},spacing:4,components:{MuiTextField:{defaultProps:{size:"small"}}}}))},q={Dark:v.a,Default:v.b};function ee(e){var t=e.width,n=e.height,r=e.userName,c=Object(b.a)({users:[]}),i=a()(c,2),s=i[0],u=i[1],d=o.a.useState($.Default),l=a()(d,2),f=l[0],v=l[1],O=o.a.useMemo((function(){return m.V()}),[]),w=o.a.useRef({user:null,mousePosition:{x:0,y:0},userInitialized:!1}),x=Object(g.a)({nodes:[],edges:[],dataBar:{editable:!0},actionBar:{theming:{options:[{name:"Light",value:"Default"},{name:"Dark",value:"Dark"}],value:"Default"}},networkStatistics:{local:{}},label:{global:{nodes:["name"],edges:["name"]},edges:{},nodes:{}},onEvent:function(e,t){var n,r=e.type,a=e.payload,c=e.elementId,o=(e.graphRef,e.graphEditor),i=(e.update,e.state,o.cy),s=(o.context,i.$id(c)),u=null!=(n=s&&Object(y.o)(s,t))?n:{};u.item,u.index;switch(r){case h.i.UPDATE_DATA:var d=a.value,l=Object(y.n)(t,o),f=l.type,p=l.selectedItem;return"nodes"===f?function(e){var t,n,r;E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.item,n=e.projectId;try{r=Object(I.c)(k,T+"/"+n+"/"+A+"/"+t.id),Object(I.g)(r,{data:t.data})}catch(c){console.log("error creating node:",c)}case 2:case"end":return a.stop()}}),null,null,null,Promise)}({projectId:X,item:{id:p.id,data:d}}):function(e){var t,n,r;E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.item,n=e.projectId;try{r=Object(I.c)(k,T+"/"+n+"/"+C+"/"+t.id),Object(I.g)(r,{data:t.data})}catch(c){console.log("error creating node:",c)}case 2:case"end":return a.stop()}}),null,null,null,Promise)}({projectId:X,item:{id:p.id,data:d}}),!1;case h.i.ADD_NODE:var b=a.items;a.edgeItems;return b.forEach((function(e){!function(e){var t,n,r;E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.projectId,n=e.item;try{m.V(),r=Object(I.c)(k,T+"/"+t+"/"+A+"/"+n.id),Object(I.f)(r,n)}catch(c){console.log("error creating node:",c)}case 2:case"end":return a.stop()}}),null,null,null,Promise)}({projectId:X,item:Q(Q({},e),{},{data:Q(Q({},e.data),{},{name:"Node-"+m.O(4,e.id)})})})})),t.mode===h.f.ADD&&(t.mode=h.f.DEFAULT),!1;case h.i.DELETE_NODE:var j=a.itemIds,g=void 0===j?[]:j;return g.forEach((function(e){!function(e){var t,n,r;E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.id,n=e.projectId;try{r=Object(I.c)(k,T+"/"+n+"/"+A+"/"+t),Object(I.b)(r)}catch(c){console.log("error creating node:",c)}case 2:case"end":return a.stop()}}),null,null,null,Promise)}({projectId:X,id:e})})),t.edges.forEach((function(e){(g.includes(e.source)||g.includes(e.target))&&z({projectId:X,id:e.id})})),t.mode===h.f.DELETE&&(t.mode=h.f.DEFAULT),!1;case h.i.ADD_EDGE:return a.items.forEach((function(e){!function(e){var t,n,r;E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.projectId,n=e.item;try{m.V(),r=Object(I.c)(k,T+"/"+t+"/"+C+"/"+n.id),Object(I.f)(r,n)}catch(c){console.log("error creating node:",c)}case 2:case"end":return a.stop()}}),null,null,null,Promise)}({projectId:X,item:Q(Q({},e),{},{data:Q(Q({},e.data),{},{name:"Edge-"+m.O(4,e.id)})})})})),t.mode===h.f.ADD&&(t.mode=h.f.DEFAULT),!1;case h.i.DELETE_EDGE:var O=a.itemIds;return(void 0===O?[]:O).forEach((function(e){z({projectId:X,id:e})})),t.mode===h.f.DELETE&&(t.mode=h.f.DEFAULT),!1;case h.i.CHANGE_THEME:var w=a.value;return console.log("CHANGE_THEME",a,w),t.graphConfig.theme=q[w],v($[w]),t.actionBar.theming.value=w,!1}}}),D=a()(x,2),P=D[0],S=D[1],R=P.ref,G=o.a.useCallback((function(){w.current.user=null,M({projectId:X,id:O})}),[O]),U=o.a.useCallback((function(){var e={id:O,name:r,position:w.current.mousePosition};return w.current.user=e,F({projectId:X,user:e}),e}),[O]);return function(e){var t=e.onEvent,n=e.projectId;Object(L.m)((function(){var e=Object(I.a)(k,T+"/"+n+"/"+A);Object(I.e)(e,(function(e){e.docChanges().forEach((function(e){var n=e.doc.data();t({elementType:"nodes",data:n,type:e.type})}))}))})),Object(L.m)((function(){var e=Object(I.a)(k,T+"/"+n+"/"+C);Object(I.e)(e,(function(e){e.docChanges().forEach((function(e){var n=e.doc.data();t({elementType:"edges",data:n,type:e.type})}))}))}))}({projectId:X,onEvent:function(e){var t=e.type,n=e.data,r=e.elementType;S.update((function(e){var a=e[r];switch(t){case"added":a.push(n);break;case"modified":a.forEach((function(e,t){e.id===n.id&&(a[t]=n)}));break;case"removed":e[r]=a.filter((function(e){return e.id!==n.id})),"nodes"===r&&(e.edges=e.edges.filter((function(e){return n.id!==e.source&&n.id!==e.target})))}}))}}),function(e){var t=e.onEvent,n=e.projectId;Object(L.m)((function(){var e=Object(I.a)(k,T+"/"+n+"/"+N);Object(I.e)(e,(function(e){e.docChanges().forEach((function(e){var n=e.doc.data();t({elementType:"users",data:n,type:e.type})}))}))}))}({projectId:X,onEvent:function(e){var t=e.type,n=e.data;e.elementType;n.id!==O&&u((function(e){switch(t){case"added":e.users.push(n);break;case"modified":e.users.forEach((function(t,r){t.id===n.id&&(e.users[r]=n)}));break;case"removed":e.users=e.users.filter((function(e){return e.id!==n.id}))}}))}}),o.a.useEffect((function(){var e=function(e){return function(t){switch(e){case"visibilitychange":"visible"===document.visibilityState?U():G();break;case"focus":U();break;case"blur":case"blur":case"beforeunload":G()}console.log("Focus change",t)}},t=e("focus"),n=e("blur"),a=e("visibilitychange"),c=e("beforeunload");window.addEventListener("visibilitychange",a,!1),window.addEventListener("blur",n,!1),window.addEventListener("focus",t,!1),window.addEventListener("beforeunload",c,!1);var o={current:!0},i=setInterval((function(){o.current=!0}),1e3),s=m.e((function(e){o.current=!1;var t=Object(y.m)(R.current.viewport,e);F({projectId:X,user:{id:O,name:r,position:t}})}),500),u=function(e){w.current.mousePosition=Object(y.m)(R.current.viewport,e),w.current.user||w.current.userInitialized||(w.current.userInitialized=!0,U()),s(e)};return document.addEventListener("mousemove",u),function(){M({projectId:X,id:O}),clearInterval(i),document.removeEventListener("mousemove",u),window.removeEventListener("visibilitychange",a,!1),window.removeEventListener("blur",n,!1),window.removeEventListener("focus",t,!1),window.removeEventListener("beforeunload",c,!1)}}),[]),Object(W.jsx)(p.a,{theme:f,children:Object(W.jsx)(j.a,Q(Q({style:{width:t,height:n}},P),{},{children:s.users.map((function(e){return O!==e.id&&Object(W.jsx)(Y,{user:e,color:16724736,position:e.position,label:e.name},e.id)}))}))})}var te=n(897),ne=n(907),re=n(909),ae=n(908),ce=n(892),oe=n(906),ie=function(e){var t=e.onSubmit,n=o.a.useState(""),r=a()(n,2),c=r[0],i=r[1];return Object(W.jsxs)(ne.a,{open:!0,children:[Object(W.jsx)(ce.a,{children:"Set Your Name"}),Object(W.jsx)(ae.a,{children:Object(W.jsx)(oe.a,{autoFocus:!0,margin:"dense",id:"name",label:"User name",fullWidth:!0,variant:"standard",value:c,onChange:function(e){return i(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&t(c)}})}),Object(W.jsx)(re.a,{children:Object(W.jsx)(te.a,{onClick:function(){return t(c)},children:"Start"})})]})};function se(){var e=Object(L.k)(),t=e.width,n=e.height,r=e.onLayout,c=Object(b.a)({isLoading:!0,name:""}),i=a()(c,2),d=i[0],l=i[1],f=function(){var e=Object(b.a)({user:null,isLoading:!0,signin:function(){var e,t;return E.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r((function(e){e.isLoading=!0})),n.next=4,E.a.awrap(Object(D.c)(S,new D.a));case 4:e=n.sent,console.log("AA",e),t=e.user,r((function(e){e.isLoading=!1,e.user=t})),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),alert("There is an error with your login! Refresh the page and try again!"),console.log("error",n.t0);case 14:case"end":return n.stop()}}),null,null,[[0,10]],Promise)}}),t=a()(e,2),n=t[0],r=t[1];return o.a.useEffect((function(){!function(){var e;E.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.a.awrap(new Promise((function(e,t){S.onAuthStateChanged((function(t,n){e(t)}))})));case 2:e=t.sent,r((function(t){t.isLoading=!1,t.user=e}));case 4:case"end":return t.stop()}}),null,null,null,Promise)}()}),[]),n}();return console.log("Auth result",f),f.isLoading?Object(W.jsx)(u.a,{}):f.user?Object(W.jsx)(s.a,{style:ue.container,onLayout:r,children:d.isLoading?Object(W.jsx)(ie,{onSubmit:function(e){l((function(t){t.isLoading=!1,t.name=e}))}}):Object(W.jsx)(ee,{width:t,height:n,userName:d.name})}):Object(W.jsx)(te.a,{onClick:function(){return f.signin()},children:"Signin"})}var ue=i.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"}})},576:function(e,t,n){e.exports=n(819)}},[[576,1,2]]]);
//# sourceMappingURL=app.ae580508.chunk.js.map